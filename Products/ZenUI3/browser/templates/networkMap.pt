<!--
###########################################################################
#
# This program is part of Zenoss Core, an open source monitoring platform.
# Copyright (C) 2009, Zenoss Inc.
#
# This program is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License version 2 or (at your
# option) any later version as published by the Free Software Foundation.
#
# For complete information please visit: http://www.zenoss.com/oss/
#
###########################################################################
-->

<tal:block metal:use-macro="context/page_macros/base-new">

<tal:block metal:fill-slot="title">Network Map</tal:block>

<tal:block metal:fill-slot="head-local">
    <script type="text/javascript" tal:define="classlist python:[dict(label=x,data=x) for x in 
                        here.dmd.Devices.deviceMoveTargets()];
                        initobj python:here.dmd.ZenUsers.getUserSettings(
                                       ).netMapStartObject"
        tal:content="string:
       _deviceClasses = ${classlist};
       _initialObjId = '${initobj}';
    "></script>
    <script language="javascript" type="text/javascript">
        function getDevClassList() {
            return _deviceClasses;
        }
        function getInitialObjId() {
            return _initialObjId;
        }
        function goToDeviceSearch(objid) {
            url = '/zport/dmd/goToStatusPage?objid=' + escape(objid);
            window.location.href = url;
        }
    </script>

    <script type="text/javascript" src="/++resource++zenui/js/swfobject/2.2/swfobject.js"></script>
    <style type="text/css">
      #center { height: 100%; overflow: hidden;}
      #zennetmap {
        height: 100%;
        overflow: hidden;
        position: relative; 
      }
    </style>

</tal:block>


<tal:block metal:fill-slot="center_panel_content">
<div id="zennetmap">
  <a href="http://www.adobe.com/go/getflashplayer">
    <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif"
         alt="Get Adobe Flash player" />
  </a>
</div>
</tal:block>

<tal:block metal:fill-slot="script_afterLayout">
<!-- Use this slot to perform any post-layout steps. -->
    <script type="text/javascript">
        Ext.onReady(function(){
            var flashvars = {};
            var params = {};
            params.allowscriptaccess = "always";
            params.allownetworking = "all";
            var attributes = {};
            swfobject.embedSWF("/zport/dmd/flex/ZenNetMap.swf",
                "zennetmap", "100%", "100%", "9.0.0",
                "/++resource++zenui/js/swfobject/2.2/expressInstall.swf",
                flashvars, params, attributes);
        });
    </script>
</tal:block>
</tal:block> <!-- metal:use-macro="context/page_macros/masterdetailsplit2" -->
