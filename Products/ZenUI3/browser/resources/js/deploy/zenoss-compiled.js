/*
 * Copyright (c) 2009 Zenoss, Inc.
 * 
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * version 2 as published by the Free Software Foundation.
 * 
 * For complete information please visit http://www.zenoss.com/oss/
 */
(function(){Ext.namespace("Zenoss");Ext.namespace("Zenoss.env");Ext.QuickTips.init();Ext.state.Manager.setProvider(new Ext.state.CookieProvider({expires:new Date(new Date().getTime()+(1000*60*60*24*30))}));Ext.Direct.on("event",function(d){try{if(d.status){YAHOO.zenoss.Messenger.clearConnectionErrors()}else{YAHOO.zenoss.Messenger.connectionError()}}catch(d){Ext.emptyFn()}Zenoss.env.asof=d.asof||null});_oldGetCallData=Ext.direct.RemotingProvider.prototype.getCallData;Ext.override(Ext.direct.RemotingProvider,{getCallData:function(d){return Ext.apply(_oldGetCallData.apply(this,arguments),{asof:Zenoss.env.asof})}});Zenoss.PlaceholderPanel=Ext.extend(Ext.Panel,{constructor:function(d){Ext.apply(d,{cls:"placeholder",layout:"fit",border:false,items:[{baseCls:"inner",border:false,html:d.text,listeners:{resize:function(e){e.getEl().setStyle({"line-height":e.getEl().getComputedHeight()+"px"})}}}]});Zenoss.PlaceholderPanel.superclass.constructor.apply(this,arguments)}});Zenoss.LargeToolbar=Ext.extend(Ext.Toolbar,{constructor:function(d){Ext.apply(d,{cls:"largetoolbar",height:45,border:false});Zenoss.LargeToolbar.superclass.constructor.apply(this,arguments)}});Ext.reg("largetoolbar",Zenoss.LargeToolbar);Zenoss.ExtraHooksSelectionModel=Ext.extend(Ext.ux.grid.livegrid.RowSelectionModel,{initEvents:function(){Zenoss.ExtraHooksSelectionModel.superclass.initEvents.call(this);this.addEvents("rangeselect")},selectRange:function(e,d,f){this.suspendEvents();Zenoss.ExtraHooksSelectionModel.superclass.selectRange.apply(this,arguments);this.resumeEvents();this.fireEvent("rangeselect",this)}});Zenoss.PostRefreshHookableDataView=Ext.extend(Ext.DataView,{constructor:function(d){Zenoss.PostRefreshHookableDataView.superclass.constructor.apply(this,arguments);this.addEvents("afterrefresh")}});Ext.extend(Zenoss.PostRefreshHookableDataView,Ext.DataView,{refresh:function(){this.clearSelections(false,true);this.el.update("");var d=this.store.getRange();if(d.length<1){if(!this.deferEmptyText||this.hasSkippedEmptyText){this.el.update(this.emptyText)}this.hasSkippedEmptyText=true;this.all.clear();return}this.tpl.overwrite(this.el,this.collectData(d,0));this.fireEvent("afterrefresh",this);this.all.fill(Ext.query(this.itemSelector,this.el.dom));this.updateIndexes(0)}});Zenoss.LiveGridInfoPanel=Ext.extend(Ext.Toolbar.TextItem,{displayMsg:"Displaying {0} - {1} of {2} events",emptyMsg:"No events",cls:"livegridinfopanel",initComponent:function(){this.setText(this.emptyMsg);if(this.grid){this.grid=Ext.getCmp(this.grid);var d=this;this.view=this.grid.getView();this.view.init=this.view.init.createSequence(function(){d.bind(this)},this.view)}Zenoss.LiveGridInfoPanel.superclass.initComponent.call(this)},updateInfo:function(g,f,d){var e=d==0?this.emptyMsg:String.format(this.displayMsg,g+1,g+f,d);this.setText(e)},bind:function(d){this.view=d;var e=d.ds;d.on("rowremoved",this.onRowRemoved,this);d.on("rowsinserted",this.onRowsInserted,this);d.on("beforebuffer",this.beforeBuffer,this);d.on("cursormove",this.onCursorMove,this);d.on("buffer",this.onBuffer,this)},onCursorMove:function(e,g,f,d){this.updateInfo(g,f,d)},onRowsInserted:function(e,f,d){this.updateInfo(e.rowIndex,Math.min(e.ds.totalLength,e.visibleRows-e.rowClipped),e.ds.totalLength)},onRowRemoved:function(e,f,d){this.updateInfo(e.rowIndex,Math.min(e.ds.totalLength,e.visibleRows-e.rowClipped),e.ds.totalLength)},beforeBuffer:function(e,f,j,h,d,g){this.updateInfo(j,h,d)},onBuffer:function(e,f,h,g,d){this.updateInfo(h,g,d)}});Ext.reg("livegridinfo",Zenoss.LiveGridInfoPanel);Zenoss.FilterGridView=Ext.extend(Ext.ux.grid.livegrid.GridView,{rowHeight:22,rowColors:false,liveSearch:true,constructor:function(d){if(typeof(d.displayFilters)=="undefined"){d.displayFilters=true}Zenoss.FilterGridView.superclass.constructor.apply(this,arguments);Ext.applyIf(this.lastOptions,this.defaultFilters||{})},lastOptions:{},initEvents:function(){Zenoss.FilterGridView.superclass.initEvents.call(this);this.addEvents("filterchange");this.addEvents("filtertoggle")},initData:function(e,d){this.un("beforebuffer",this.onBeforeBuffer,this);d.un("hiddenchange",this.updateHeaders,this);this.on("beforebuffer",this.onBeforeBuffer,this);d.on("hiddenchange",this.updateHeaders,this);Zenoss.FilterGridView.superclass.initData.call(this,e,d)},applyFilterParams:function(d){var d=d||{},h=this.lastOptions||{};for(i=0;i<this.filters.length;i++){var e=this.filters[i];var g,f;f=e.getValue();if(f){h[e.id]=f;if(e.xtype=="datefield"){dt=new Date(f);f=dt.format(Zenoss.date.UniversalSortableDateTime)}}else{delete h[e.id]}}Ext.apply(d.params,{params:Ext.util.JSON.encode(h),uid:this._context});this.lastOptions=h},setContext:function(d){this._context=d;this.updateLiveRows(this.rowIndex,true,true)},onBeforeLoad:function(d,e){this.applyFilterParams(e);return Zenoss.FilterGridView.superclass.onBeforeLoad.call(this,d,e)},onBeforeBuffer:function(e,f,j,h,d,g){this.applyFilterParams(g);return true},getFilterCt:function(){return Ext.select(".x-grid3-filter")},hideFilters:function(){this.setFiltersDisplayed(false)},showFilters:function(){this.setFiltersDisplayed(true)},clearFilters:function(){Ext.each(this.filters,function(d){d.reset()},this);this.updateLiveRows(this.rowIndex,true,true)},setFiltersDisplayed:function(d){d=true;this.displayFilters=d;this.getFilterCt().setDisplayed(d);this.fireEvent("filtertoggle");if(d){this.renderEditors()}this.layout()},renderFilterRow:function(){var h=this.getColumnData(),f=this.templates.cell,f=new Ext.Template('<td class="x-grid3-col x-grid3-cell',' x-grid3-td-{id} {css}" style="{style}" tabIndex="-1"',' {cellAttr}> <div class="x-grid3-cell-inner',' x-grid3-col-{id}" unselectable="on" {attr}>',"{value}</div></td>"),e=[],j={},g={},d=new Ext.Template('<tr {display} class="x-grid3-filter"',">{cells}</tr>");for(i=0,len=h.length;i<len;i++){if(this.cm.isHidden(i)){continue}c=h[i];j.id=c.id;j.css="x-grid3-cell-filter";j.attr='id="filtergrid-'+c.id+'"';j.cellAttr="";j.value="";e[e.length]=f.apply(j)}g.tsyle="width:"+this.getTotalWidth()+";";g.cols=e.length;g.cells=e.join("");g.display="";return d.apply(g)},filters:[],nonDisruptiveReset:function(){this.ds.modified=[];this.rowIndex=0;this.lastScrollPos=0;this.lastRowIndex=0;this.lastIndex=0;this.adjustVisibleRows();this.adjustScrollerPos(-this.liveScroller.dom.scrollTop,true);this.showLoadMask(false);this.updateLiveRows(this.rowIndex,true,true)},renderEditors:function(){Ext.each(this.filters,function(l){l.destroy()});this.filters=[];var g=this.getColumnData();for(i=0,len=g.length;i<len;i++){if(this.cm.isHidden(i)){continue}var k=g[i],d=k.id,j="filtergrid-"+d;var e=this.cm.config[i].filter;if(e===false){e={xtype:"panel",getValue:function(){}};this.filters[this.filters.length]=Ext.create(e);continue}else{if(!e){e={xtype:"textfield"}}}Ext.apply(e,{id:d,enableKeyEvents:true,selectOnFocus:true});var f=new Ext.ComponentMgr.create(e?e:{xtype:"textfield",validationDelay:500});if(this.lastOptions){var h=this.lastOptions[d];f.setValue(h)}f.setWidth("100%");this.filters[this.filters.length]=f;f.liveSearchTask=new Ext.util.DelayedTask(function(){this.fireEvent("filterchange",this);if(this.liveSearch){this.nonDisruptiveReset()}},this);if(f instanceof Ext.form.TextField){f.on("keyup",function(m,l){if(!l.isNavKeyPress()){this.liveSearchTask.delay(1000)}},f)}else{f.on("select",function(m,l){this.liveSearchTask.delay(1000)},f);f.on("change",function(m,l){this.liveSearchTask.delay(1000)},f)}new Ext.Panel({frame:false,border:false,layout:"fit",renderTo:j,items:f})}},updateHeaders:function(){Zenoss.FilterGridView.superclass.updateHeaders.call(this);this.renderEditors()},renderUI:function(){Zenoss.FilterGridView.superclass.renderUI.call(this)},renderHeaders:function(){html=Zenoss.FilterGridView.superclass.renderHeaders.call(this);html=html.slice(0,html.length-8);html=html+this.renderFilterRow()+"</table>";return html},getState:function(){this.applyFilterParams();var d={};Ext.iterate(this.lastOptions,function(e){var j=this.defaultFilters||{},h=j[e],g=this.lastOptions[e];if(h){var f;if(Ext.isDate(h)&&Ext.isDate(g)){var l=Math.abs(h.getTime()-g.getTime());f=l<=1000}else{f=h==g}if(!f){d[e]=g}}else{d[e]=g}},this);return{displayFilters:this.displayFilters,options:d}},getFilterButton:function(){return Ext.getCmp(this.filterbutton)},getRowClass:function(e,f){var g=e.get("eventState")=="New"?"unacknowledged":"acknowledged";var h=Zenoss.util.convertSeverity(e.get("severity"));var d=this.rowColors?h+" rowcolor":"";return g+" "+d},toggleRowColors:function(d){this.rowColors=d;Ext.state.Manager.set("rowcolor",d);this.updateLiveRows(this.rowIndex,true,false)},toggleLiveSearch:function(d){this.liveSearch=d;Ext.state.Manager.set("livesearch",d)},applyState:function(d){this.displayFilters=true;this.lastOptions=d.options;Ext.applyIf(this.lastOptions,this.defaultFilters||{})},resetFilters:function(){this.lastOptions={};Ext.applyIf(this.lastOptions,this.defaultFilters||{})}});Zenoss.FilterGridPanel=Ext.extend(Ext.ux.grid.livegrid.GridPanel,{initStateEvents:function(){Zenoss.FilterGridPanel.superclass.initStateEvents.call(this);this.mon(this.view,"filterchange",this.saveState,this);this.mon(this.view,"filtertoggle",this.saveState,this)},getView:function(){if(!this.view){this.view=new Zenoss.FilterGridView(this.viewConfig)}return this.view},restoreURLState:function(){var d=window.location.search.replace(/^\?/,""),f=Ext.urlDecode(d).state;if(f){try{f=Ext.decode(Zenoss.util.base64.decode(f));this.applyState(f)}catch(g){noop()}}},clearURLState:function(){var d=window.location.search.replace(/^\?/,""),d=Ext.urlDecode(d);if(d.state){delete d.state;d=Ext.urlEncode(d);if(d){window.location.search="?"+Ext.urlEncode(d)}else{window.location.search=""}}},getPermalink:function(){var d=window.location,e=d.protocol+"//"+d.host+d.pathname;st=Zenoss.util.base64.encode(Ext.encode(this.getState()));return e+"?state="+st},initState:function(){Zenoss.FilterGridPanel.superclass.initState.apply(this,arguments);this.restoreURLState();var d=Ext.getCmp(this.view.livesearchitem);if(d){var f=Ext.state.Manager.get("livesearch");if(!Ext.isDefined(f)){f=d.checked}else{d.on("render",function(){this.setChecked(f)},d)}this.view.liveSearch=f}var e=Ext.state.Manager.get("rowcolor");this.view.rowColors=e;if(this.view.rowcoloritem){var g=Ext.getCmp(this.view.rowcoloritem);g.on("render",function(){this.setChecked(e)},g)}},getState:function(){var e=Zenoss.FilterGridPanel.superclass.getState.call(this);var d=this.getView().getState();e.filters=d;return e},applyState:function(f){var d=Ext.pluck(this.initialConfig.cm.config,"id"),g=[],e={};Ext.each(f.columns,function(h){if(d.indexOf(h.id)>-1){g.push(h)}});Ext.iterate(f.filters.options,function(h){if(d.indexOf(h)>-1){e[h]=f.filters.options[h]}});f.columns=g;f.filters.options=e;this.getView().applyState(f.filters);Zenoss.FilterGridPanel.superclass.applyState.apply(this,arguments)},resetGrid:function(){Ext.state.Manager.clear(this.getItemId());var d=this.getView();d.resetFilters();Zenoss.remote.EventsRouter.column_config({},function(f){var g=[];Ext.each(f,function(h){g[g.length]=Ext.decode(h)});var e=new Ext.grid.ColumnModel(g);this.store.sortInfo=this.store.defaultSort;this.reconfigure(this.store,e);d.fitColumns();d.showLoadMask(true);d.nonDisruptiveReset();this.saveState();this.clearURLState()},this)},setContext:function(d){this.view.setContext(d)},hideFilters:function(){this.getView().hideFilters()},showFilters:function(){this.getView().showFilters()},clearFilters:function(){this.getView().clearFilters()}});Zenoss.MultiselectMenu=Ext.extend(Ext.Toolbar.Button,{constructor:function(d){items=[];var e=this;Ext.each(d.source,function(f){items[items.length]={checked:typeof(f.checked)=="undefined",hideOnClick:false,handler:function(){e.fireEvent("change")},value:f.value,text:f.text}});d.menu={items:items};Zenoss.MultiselectMenu.superclass.constructor.apply(this,arguments)},reset:function(){this.setValue()},getValue:function(){var d=[];Ext.each(this.menu.items.items,function(e){if(e.checked){d[d.length]=e.value}});return d},setValue:function(d){if(!d){this.constructor(this.initialConfig)}else{Ext.each(this.menu.items.items,function(h){var f=false;try{f=d.indexOf(h.value)!=-1}catch(j){var g}h.setChecked(f)})}}});Ext.reg("multiselectmenu",Zenoss.MultiselectMenu);Zenoss.StatefulRefreshMenu=Ext.extend(Ext.menu.Menu,{constructor:function(d){d.stateful=true;d.stateEvents=["itemclick"];Zenoss.StatefulRefreshMenu.superclass.constructor.apply(this,arguments)},getState:function(){return this.trigger.interval},applyState:function(e){var d=this.items.items;Ext.each(d,function(f){if(f.value==e){f.setChecked(true)}},this);this.trigger.on("afterrender",function(){this.trigger.setInterval(e)},this)}});Ext.reg("statefulrefreshmenu",Zenoss.StatefulRefreshMenu);Zenoss.RefreshMenuButton=Ext.extend(Ext.SplitButton,{constructor:function(d){var e={xtype:"statefulrefreshmenu",id:"evc_refresh",trigger:this,items:[{xtype:"menutextitem",cls:"refreshevery",text:"Refresh every"},{xtype:"menucheckitem",text:"1 second",value:1,group:"refreshgroup"},{xtype:"menucheckitem",text:"5 seconds",value:5,group:"refreshgroup"},{xtype:"menucheckitem",text:"10 seconds",value:10,group:"refreshgroup"},{xtype:"menucheckitem",text:"30 seconds",value:30,group:"refreshgroup"},{xtype:"menucheckitem",text:"1 minute",value:60,checked:true,group:"refreshgroup"},{xtype:"menucheckitem",text:"Manually",value:-1,group:"refreshgroup"}]};d.menu=e;Zenoss.RefreshMenuButton.superclass.constructor.apply(this,arguments);this.refreshTask=new Ext.util.DelayedTask(this.poll,this);this.menu.on("itemclick",function(f){this.setInterval(f.value)},this);this.setInterval(60)},setInterval:function(d){this.interval=d;this.refreshTask.delay(this.interval*1000)},poll:function(){if(this.interval>0){this.handler();this.refreshTask.delay(this.interval*1000)}}});Ext.reg("refreshmenu",Zenoss.RefreshMenuButton);Zenoss.DetailPanel=Ext.extend(Ext.Panel,{isHistory:false,constructor:function(d){d.onDetailHide=d.onDetailHide||function(){var e};d.layout="border";d.border=false;d.defaults={border:false};d.items=[{id:"evdetail_hd",region:"north",layout:"border",height:50,cls:"evdetail_hd",defaults:{border:false},items:[{region:"west",width:77,layout:"hbox",defaults:{border:false},items:[{id:"severity-icon",cls:"severity-icon"},{id:"evdetail-sep",cls:"evdetail-sep"}]},{region:"center",id:"evdetail-summary",html:""},{region:"east",id:"evdetail-tools",layout:"hbox",width:57,defaults:{border:false},items:[{id:"evdetail-popout",cls:"evdetail-popout"},{id:"evdetail_tool_close",cls:"evdetail_close"}]}]},{id:"evdetail_bd",region:"center",defaults:{frame:false,border:false},autoScroll:true,layout:"table",layoutConfig:{columns:1,tableAttrs:{style:{width:"90%"}}},cls:"evdetail_bd",items:[{id:"evdetail_props",cls:"evdetail_props",html:""},{id:"show_details",cls:"show_details",hidden:true,html:"Show more details..."},{id:"full_event_props",cls:"full_event_props",hidden:true,html:""},{id:"evdetail-log-header",cls:"evdetail-log-header",hidden:true,html:"<hr/><h2>LOG</h2>"},{xtype:"form",id:"log-container",defaults:{border:false},frame:true,layout:"table",style:{"margin-left":"3em"},hidden:true,labelWidth:1,items:[{id:"detail-logform-evid",xtype:"hidden",name:"evid"},{style:"margin:0.75em",width:300,xtype:"textfield",name:"message",id:"detail-logform-message"},{xtype:"button",type:"submit",name:"add",text:"Add",handler:function(f,j){var g=Ext.getCmp("log-container"),h=g.getForm().getValues();params={history:this.isHistory};Ext.apply(params,h);Zenoss.remote.EventsRouter.write_log(params,function(k,e){Ext.getCmp("detail-logform-message").setRawValue("");Ext.getCmp(d.id).load(Ext.getCmp("detail-logform-evid").getValue())})}}]},{id:"evdetail_log",cls:"log-content",hidden:true}]}];Zenoss.DetailPanel.superclass.constructor.apply(this,arguments)},setSummary:function(e){var d=Ext.getCmp("evdetail-summary");d.el.update(e)},setSeverityIcon:function(e){var d=Ext.getCmp("severity-icon");this.clearSeverityIcon();d.addClass(e)},clearSeverityIcon:function(){var d=Ext.getCmp("severity-icon");Ext.each(Zenoss.env.SEVERITIES,function(e){var e=e[1];d.removeClass(e.toLowerCase())})},update:function(k){var l=new Ext.XTemplate.from("detail_table_template");var e=new Ext.XTemplate.from("fullprop_table_template");var f=new Ext.XTemplate.from("log_table_template");var g=Zenoss.util.convertSeverity(k.severity),h=l.applyTemplate(k),d=e.applyTemplate(k),j=f.applyTemplate(k);this.setSummary(k.summary);this.setSeverityIcon(g);Ext.getCmp("evdetail_props").el.update(h);Ext.getCmp("full_event_props").el.update(d);Ext.getCmp("evdetail_log").el.update(j);Ext.getCmp("detail-logform-evid").setValue(k.evid)},wipe:function(){this.clearSeverityIcon();this.setSummary("");Ext.getCmp("show_details").hide();Ext.getCmp("evdetail-log-header").hide();Ext.getCmp("evdetail_log").hide();Ext.getCmp("evdetail_props").hide();Ext.getCmp("full_event_props").hide();Ext.getCmp("log-container").hide()},show:function(){Ext.getCmp("show_details").show();Ext.getCmp("evdetail-log-header").show();Ext.getCmp("evdetail_log").show();Ext.getCmp("evdetail_props").show();if(this.isPropsVisible){Ext.getCmp("full_event_props").show()}Ext.getCmp("log-container").show()},isPropsVisible:false,showProps:function(){el=Ext.getCmp("full_event_props");tgl=Ext.getCmp("show_details");if(!el.hidden){el.hide();this.isPropsVisible=false;tgl.body.update("Show more details...")}else{el.show();this.isPropsVisible=true;tgl.body.update("Hide details")}},popout:function(){var e=Ext.getCmp("detail-logform-evid").getValue(),d=this.isHistory?"viewHistoryDetail":"viewDetail";window.open(d+"?evid="+e,e,"status=1,width=600,height=500")},bind:function(){var e=Ext.getCmp("show_details").getEl(),f=Ext.getCmp("evdetail_tool_close").getEl(),d=Ext.getCmp("evdetail-popout").getEl();e.un("click",this.showProps);e.on("click",this.showProps);f.un("click",this.onDetailHide);f.on("click",this.onDetailHide);d.un("click",this.popout,this);d.on("click",this.popout,this)},load:function(d){Zenoss.remote.EventsRouter.detail({evid:d,history:this.isHistory},function(e){var f=e.event[0];this.update(f);this.bind();this.show()},this)}});Ext.reg("detailpanel",Zenoss.DetailPanel);Zenoss.ColumnFieldSet=Ext.extend(Ext.form.FieldSet,{constructor:function(f){var e={items:{layout:"column",border:false,items:f.__inner_items__,defaults:{layout:"form",border:false,labelSeparator:" "}}};delete f.__inner_items__;var d=Ext.apply(e,f);Zenoss.ColumnFieldSet.superclass.constructor.call(this,d)}});Ext.reg("ColumnFieldSet",Zenoss.ColumnFieldSet);Ext.namespace("Zenoss.util");Zenoss.env.SEVERITIES=[[5,"Critical"],[4,"Error"],[3,"Warning"],[2,"Info"],[1,"Debug"],[0,"Clear"]];Zenoss.util.convertSeverity=function(d){sevs=["clear","debug","info","warning","error","critical"];return sevs[d]};Zenoss.util.convertStatus=function(e){var d=["New","Acknowledged","Suppressed"];return d[e]};Zenoss.util.render_severity=function(d){return'<div class="severity-icon-small '+Zenoss.util.convertSeverity(d)+'"></div>'};Zenoss.util.render_status=function(d){return'<div class="status-icon-small '+d.toLowerCase()+'"></div>'};Zenoss.util.render_linkable=function(g,f,d){var e=d.data[f.id+"_url"];if(e){return'<a href="'+e+'">'+g+"</a>"}else{return g}};Zenoss.util.base64={base64s:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",encode:function(f){if(typeof btoa==="function"){return btoa(f)}var j=this.base64s;var e;var h;var d=0;var g="";while(f.length>=d+3){e=(f.charCodeAt(d++)&255)<<16|(f.charCodeAt(d++)&255)<<8|f.charCodeAt(d++)&255;g+=j.charAt((e&16515072)>>18)+j.charAt((e&258048)>>12)+j.charAt((e&4032)>>6)+j.charAt((e&63))}if(f.length-d>0&&f.length-d<3){h=Boolean(f.length-d-1);e=((f.charCodeAt(d++)&255)<<16)|(h?(f.charCodeAt(d)&255)<<8:0);g+=j.charAt((e&16515072)>>18)+j.charAt((e&258048)>>12)+(h?j.charAt((e&4032)>>6):"=")+"="}return(g)},decode:function(f){if(typeof atob==="function"){return atob(f)}var h=this.base64s;var g;var d="";var e=0;for(;e<f.length;e+=4){g=(h.indexOf(f.charAt(e))&255)<<18|(h.indexOf(f.charAt(e+1))&255)<<12|(h.indexOf(f.charAt(e+2))&255)<<6|h.indexOf(f.charAt(e+3))&255;d+=String.fromCharCode((g&16711680)>>16,(g&65280)>>8,g&255)}if(f.charCodeAt(e-2)==61){return(d.substring(0,d.length-2))}else{if(f.charCodeAt(e-1)==61){return(d.substring(0,d.length-1))}else{return(d)}}}};Zenoss.util.dot2num=function(e){var f=e.split(".");return((((((+f[0])*256)+(+f[1]))*256)+(+f[2]))*256)+(+f[3])};Zenoss.util.num2dot=function(e){var g=e%256;for(var f=3;f>0;f--){e=Math.floor(e/256);g=e%256+"."+g}return g};Zenoss.util.setContext=function(d){var e=Array.prototype.slice.call(arguments,1);Ext.each(e,function(f){Ext.getCmp(f).setContext(d)})};Ext.ns("Zenoss.render");var b=new Ext.Template('<td class="severity-icon-small {severity}">{count}</td>');b.compile();var a=new Ext.Template('<table class="eventrainbow"><tr>{cells}</tr></table>');a.compile();Zenoss.render.events=function(e){var d="";Ext.each(["critical","error","warning"],function(f){d+=b.apply({severity:f,count:e[f]})});return a.apply({cells:d})};Zenoss.render.availability=function(d){return Ext.util.Format.number(d*100,"0.000%")};Zenoss.render.deviceClass=function(e){e=e.replace(/^\/zport\/dmd\/Devices/,"");e=e.replace(/\/devices\/.*$/,"");var d="/zport/dmd/itinfrastructure#devices:/Devices"+e;return'<a href="'+d+'">'+e+"</a>"};Zenoss.ThrottlingProxy=Ext.extend(Ext.data.DirectProxy,{constructor:function(d){Zenoss.ThrottlingProxy.superclass.constructor.apply(this,arguments);this.loading=false;this.addListener("beforeload",function(f,e){if(!f.loading){f.loading=true;return true}return false});this.addListener("load",function(f,e){f.loading=false});this.addListener("exception",function(f,e){f.loading=false})}});Ext.namespace("Zenoss.date");Ext.apply(Zenoss.date,{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"})})();(function(){Ext.ns("Zenoss","Zenoss.i18n");Zenoss.i18n._data=Zenoss.i18n._data||{};Zenoss.i18n.translate=function(a,b){t=Zenoss.i18n._data[a];return t?t:(b?b:a)};window._t=Zenoss.i18n.translate})();(function(){Zenoss.registerTooltip=function(a){var b=Ext.getCmp(a.target);if(typeof(b)!="undefined"){if(b.btnEl){a.target=b.btnEl}}new Ext.ToolTip(a)}})();(function(){var a=Ext.History;a.DELIMITER=":";a.selectByToken=function(b){if(b){var f=b.split(a.DELIMITER),e=Ext.getCmp(f[0]),d=f.slice(1).join(a.DELIMITER);if(e){e.selectByToken(d)}}};a.on("change",a.selectByToken)})();(function(){Ext.ns("Zenoss");var a=Ext.extend(Ext.Window,{constructor:function(b){Ext.applyIf(b,{autoHeight:true,width:310,closeAction:"hide",plain:true,buttonAlign:"left",padding:10,modal:true});a.superclass.constructor.call(this,b)}});Zenoss.DialogButton=Ext.extend(Ext.Button,{constructor:function(b){if(!Ext.isDefined(b.handler)){b.handler=function(){}}b.handler=b.handler.createSequence(function(e){var d=e.findParentBy(function(f){return f.id==b.dialogId});d.hide()});Zenoss.DialogButton.superclass.constructor.call(this,b)}});Ext.reg("DialogButton",Zenoss.DialogButton);Zenoss.MessageDialog=Ext.extend(a,{constructor:function(b){Ext.applyIf(b,{layout:"fit",items:{border:false,html:b.message},buttons:[{xtype:"DialogButton",text:_t("OK"),handler:b.okHandler,dialogId:b.id},{xtype:"DialogButton",text:_t("Cancel"),handler:b.cancelHandler,dialogId:b.id}]});Zenoss.MessageDialog.superclass.constructor.call(this,b)}});Zenoss.FormDialog=Ext.extend(a,{constructor:function(b){Ext.applyIf(b,{layout:"form",labelAlign:"top",labelSeparator:" "});Zenoss.FormDialog.superclass.constructor.call(this,b)}})})();(function(){Ext.ns("Zenoss");function b(d){new Zenoss.FormDialog({id:"addNodeDialog",title:_t("Add Tree Node"),items:[{xtype:"combo",id:"typeCombo",fieldLabel:_t("Type"),displayField:"type",mode:"local",forceSelection:true,triggerAction:"all",emptyText:"Select a type...",selectOnFocus:true,store:new Ext.data.ArrayStore({fields:["type"],data:[["Organizer"],["Class"]]})},{xtype:"textfield",id:"idTextfield",fieldLabel:_t("ID"),allowBlank:false}],listeners:{hide:function(e){Ext.getCmp("typeCombo").setValue("");Ext.getCmp("idTextfield").setValue("")}},buttons:[{xtype:"DialogButton",text:_t("Submit"),dialogId:"addNodeDialog",handler:function(e,g){var f=Ext.getCmp("typeCombo").getValue();var h=Ext.getCmp("idTextfield").getValue();d.addNode(f,h)}},{xtype:"DialogButton",text:_t("Cancel"),dialogId:"addNodeDialog"}]});new Zenoss.MessageDialog({id:"deleteNodeDialog",title:_t("Delete Tree Node"),message:_t("The selected node will be deleted."),okHandler:function(){d.deleteSelectedNode()}})}function a(d){switch(d){case"addButton":Ext.getCmp("addNodeDialog").show();break;case"deleteButton":Ext.getCmp("deleteNodeDialog").show();break}}Zenoss.HierarchyTreeNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{buildNodeText:function(f){var d=[];var e=f.attributes.text;if(f.isLeaf()){d.push(e.text)}else{d.push("<strong>"+e.text+"</strong>")}if(e.count!=undefined){d.push('<span class="node-extra">('+e.count);d.push((e.description||"instances")+")</span>")}return d.join(" ")},render:function(e){var f=this.node,d=f.attributes;if(d.text&&Ext.isObject(d.text)){f.text=this.buildNodeText(this.node)}Zenoss.HierarchyTreeNodeUI.superclass.render.call(this,e)},onTextChange:function(e,f,d){if(this.rendered){this.textNode.innerHTML=this.buildNodeText(e)}}});Zenoss.HierarchyRootTreeNodeUI=Ext.extend(Zenoss.HierarchyTreeNodeUI,{buildNodeText:function(f){var d=[];var e=f.attributes.text;d.push(e.substring(e.lastIndexOf("/")));if(e.count!=undefined){d.push('<span class="node-extra">('+e.count);d.push((e.description||"instances")+")</span>")}return d.join(" ")}});Zenoss.HierarchyTreePanel=Ext.extend(Ext.tree.TreePanel,{constructor:function(e){Ext.applyIf(e,{cls:"hierarchy-panel",useArrows:true,border:false,autoScroll:true,containerScroll:true,selectRootOnLoad:true});if(e.directFn&&!e.loader){e.loader={xtype:"treeloader",directFn:e.directFn,uiProviders:{hierarchy:Zenoss.HierarchyTreeNodeUI},getParams:function(f){return[f.attributes.uid]}};Ext.destroyMembers(e,"directFn")}var d=e.root||{};Ext.applyIf(d,{nodeType:"async",id:d.id,uid:d.uid,text:_t(d.text||d.id)});if(e.selectRootOnLoad){e.listeners=Ext.applyIf(e.listeners||{},{render:function(f){f.getRootNode().on("load",function(g){g.select()})}})}e.listeners=Ext.applyIf(e.listeners||{},{buttonClick:a});this.router=e.router;e.loader.baseAttrs={iconCls:"severity-icon-small clear"};Zenoss.HierarchyTreePanel.superclass.constructor.apply(this,arguments);b(this)},initEvents:function(){Zenoss.HierarchyTreePanel.superclass.initEvents.call(this);this.on("click",function(e,d){Ext.History.add(this.id+Ext.History.DELIMITER+e.getPath())},this)},update:function(d){function e(f,g){Ext.each(g,function(h){var j=f.findChild("id",h.id);if(j){j.attributes=h;j.setText(j.attributes.text);e(j,h.children)}})}e(this.getRootNode(),d)},selectByPath:function(d){var e=unescape(d);this.expandPath(e,"id",function(f,g){if(g&&!g.isSelected()){g.fireEvent("click",g)}})},selectByToken:function(d){if(!this.root.loaded){this.loader.on("load",function(){this.selectByPath(d)},this)}else{this.selectByPath(d)}},afterRender:function(){Zenoss.HierarchyTreePanel.superclass.afterRender.call(this);this.root.ui.addClass("hierarchy-root");Ext.removeNode(this.root.ui.getIconEl());if(this.searchField){this.filter=new Ext.tree.TreeFilter(this,{clearBlank:true,autoClear:true});this.searchField=this.add({xtype:"searchfield",bodyStyle:{padding:10},listeners:{valid:this.filterTree,scope:this}})}this.getRootNode().expand()},filterTree:function(f){var g=f.getValue();if(this.hiddenPkgs){Ext.each(this.hiddenPkgs,function(e){e.ui.show()})}this.hiddenPkgs=[];if(!g){this.filter.clear();return}this.expandAll();var d=new RegExp(Ext.escapeRe(g),"i");this.filter.filterBy(function(h){var e=false;Ext.each(h.id.split("/"),function(j){e=e||d.test(j)});return !h.isLeaf()||e});this.root.cascade(function(e){if(!e.isLeaf()&&e.ui.ctNode.offsetHeight<3){e.ui.hide();this.hiddenPkgs.push(e)}},this)},addNode:function(g,l){var h=this.getSelectionModel().getSelectedNode();var e;if(h.leaf){e=h.parentNode}else{e=h}var f=e.attributes.uid;var j={type:g,contextUid:f,id:l};var d=this;function k(p,n){var m=n.result;if(m.success){var q=n.result.nodeConfig;var o=d.getLoader().createNode(q);e.appendChild(o);o.select()}else{Ext.Msg.alert("Error",m.msg)}}this.router.addNode(j,k)},deleteSelectedNode:function(){var f=this.getSelectionModel().getSelectedNode();var d=f.parentNode;var e=f.attributes.uid;var g={uid:e};function h(k,j){d.select();d.removeChild(f);f.destroy()}this.router.deleteNode(g,h)}});Ext.reg("HierarchyTreePanel",Zenoss.HierarchyTreePanel)})();Ext.ns("Zenoss");Zenoss.SearchField=Ext.extend(Ext.form.TextField,{constructor:function(a){if(!("selectOnFocus" in a)){a.selectOnFocus=true}Zenoss.SearchField.superclass.constructor.apply(this,arguments)},getClass:function(){return this.black?"searchfield-black":"searchfield"},onRender:function(){Zenoss.SearchField.superclass.onRender.apply(this,arguments);this.wrap=this.el.boxWrap(this.getClass());if(this.bodyStyle){this.wrap.setStyle(this.bodyStyle)}this.resizeEl=this.positionEl=this.wrap;this.syncSize()},syncSize:function(){this.el.setBox(this.el.parent().getBox())}});Ext.reg("searchfield",Zenoss.SearchField);(function(){Ext.ns("Zenoss");Zenoss.EventStore=Ext.extend(Ext.ux.grid.livegrid.Store,{constructor:function(a){Ext.applyIf(a,{proxy:new Ext.data.DirectProxy({directFn:Zenoss.remote.EventsRouter.query}),bufferSize:100,defaultSort:{field:"severity",direction:"DESC"},sortInfo:{field:"severity",direction:"DESC"},reader:new Ext.ux.grid.livegrid.JsonReader({root:"events",totalProperty:"totalCount"},["dedupid","evid","device","device_url","component","component_url","summary","eventState","eventClass","eventClass_url","eventKey","message","eventClassKey","eventGroup","prodState","suppid","manager","agent","DeviceClass","Location","Systems","DeviceGroups","ipAddress","facility","priority","ntevid","ownerid","clearid","DevicePriority","eventClassMapping","monitor",{name:"count",type:"int"},{name:"severity",type:"int"},{name:"firstTime",type:"date",dateFormat:Zenoss.date.ISO8601Long},{name:"lastTime",type:"date",dateFormat:Zenoss.date.ISO8601Long},{name:"stateChange",type:"date",dateFormat:Zenoss.date.ISO8601Long}])});Zenoss.EventStore.superclass.constructor.call(this,a)}});Ext.reg("EventStore",Zenoss.EventStore);Zenoss.SimpleEventColumnModel=Ext.extend(Ext.grid.ColumnModel,{constructor:function(a){var a=Ext.applyIf(a||{},{defaults:{sortable:false,menuDisabled:true,width:200},columns:[{dataIndex:"severity",header:_t("Severity"),id:"severity",renderer:Zenoss.util.convertSeverity},{dataIndex:"device",header:_t("Device")},{dataIndex:"component",header:_t("Component")},{dataIndex:"eventClass",header:_t("Event Class")},{dataIndex:"summary",header:_t("Summary"),id:"summary"}]});Zenoss.SimpleEventColumnModel.superclass.constructor.call(this,a)}});Ext.reg("SimpleEventColumnModel",Zenoss.SimpleEventColumnModel);Zenoss.FullEventColumnModel=Ext.extend(Ext.grid.ColumnModel,{constructor:function(a){var a=Ext.applyIf(a||{},{columns:Zenoss.env.COLUMN_DEFINITIONS});Zenoss.FullEventColumnModel.superclass.constructor.call(this,a)}});Ext.reg("FullEventColumnModel",Zenoss.FullEventColumnModel);Zenoss.SimpleEventGridPanel=Ext.extend(Ext.ux.grid.livegrid.GridPanel,{constructor:function(b){var a={xtype:"EventStore"};if(!Ext.isEmpty(b.directFn)){Ext.apply(a,{proxy:new Ext.data.DirectProxy({directFn:b.directFn})})}Ext.applyIf(b,{id:"eventGrid",stripeRows:true,stateId:Zenoss.env.EVENTSGRID_STATEID||"default_eventsgrid",enableDragDrop:false,stateful:true,border:false,rowSelectorDepth:5,autoExpandColumn:"summary",store:a,cm:Ext.create({xtype:"SimpleEventColumnModel"}),sm:new Zenoss.ExtraHooksSelectionModel(),autoExpandColumn:"summary",view:new Ext.ux.grid.livegrid.GridView({nearLimit:20,loadMask:{msg:"Loading. Please wait..."},listeners:{beforeBuffer:function(f,j,e,d,h,g){g.params.uid=f._context}}})});Zenoss.SimpleEventGridPanel.superclass.constructor.call(this,b)},setContext:function(a){this.view._context=a;this.view.updateLiveRows(this.view.rowIndex,true,true)}});Ext.reg("SimpleEventGridPanel",Zenoss.SimpleEventGridPanel);Zenoss.EventRainbow=Ext.extend(Ext.Toolbar.TextItem,{constructor:function(a){var a=Ext.applyIf(a||{},{height:45,directFn:Zenoss.remote.DeviceRouter.getInfo,text:Zenoss.render.events({critical:0,error:0,warning:0})});Zenoss.EventRainbow.superclass.constructor.call(this,a)},setContext:function(a){this.directFn({uid:a},function(b){this.setText(Zenoss.render.events(b.data.events))},this)}});Ext.reg("eventrainbow",Zenoss.EventRainbow)})();(function(){Ext.ns("Zenoss");Zenoss.DeviceColumnModel=Ext.extend(Ext.grid.ColumnModel,{constructor:function(a){a=Ext.applyIf(a||{},{columns:[{dataIndex:"name",header:_t("Device"),id:"name"},{id:"ipAddress",dataIndex:"ipAddress",header:_t("IP Address"),filter:{xtype:"ipaddressfield"},renderer:Zenoss.util.num2dot},{dataIndex:"uid",header:_t("Device Class"),id:"deviceClass",renderer:Zenoss.render.deviceClass},{id:"productionState",dataIndex:"productionState",width:100,filter:{xtype:"multiselectmenu",text:"...",source:[{value:1000,text:"Production"},{value:500,text:"Pre-Production",checked:false},{value:400,text:"Test",checked:false},{value:300,text:"Maintenance",checked:false,},{value:-1,text:"Decommissioned",checked:false}]},header:_t("Production State")},{id:"events",sortable:false,filter:false,dataIndex:"events",header:_t("Events"),renderer:Zenoss.render.events}]});a.defaults=Ext.applyIf(a.defaults||{},{sortable:false,menuDisabled:true,width:200});Zenoss.DeviceColumnModel.superclass.constructor.call(this,a)}});Ext.reg("DeviceColumnModel",Zenoss.DeviceColumnModel);Zenoss.DeviceStore=Ext.extend(Ext.ux.grid.livegrid.Store,{constructor:function(a){var a=a||{};Ext.applyIf(a,{autoLoad:true,bufferSize:50,defaultSort:{field:"name",direction:"ASC"},sortInfo:{field:"name",direction:"ASC"},proxy:new Ext.data.DirectProxy({directFn:Zenoss.remote.DeviceRouter.getDevices}),reader:new Ext.ux.grid.livegrid.JsonReader({root:"devices",totalProperty:"totalCount"},[{name:"uid",type:"string"},{name:"name",type:"string"},{name:"ipAddress",type:"int"},{name:"productionState",type:"string"},{name:"events",type:"auto"},{name:"availability",type:"float"}])});Zenoss.DeviceStore.superclass.constructor.call(this,a)}});Ext.reg("DeviceStore",Zenoss.DeviceStore);Zenoss.SimpleDeviceGridPanel=Ext.extend(Ext.ux.grid.livegrid.GridPanel,{constructor:function(b){var a={xtype:"DeviceStore"};if(!Ext.isEmpty(b.directFn)){Ext.apply(a,{proxy:new Ext.data.DirectProxy({directFn:b.directFn})})}var b=Ext.applyIf(b||{},{cm:new Zenoss.DeviceColumnModel({menuDisabled:true}),sm:new Zenoss.ExtraHooksSelectionModel(),store:a,enableDragDrop:false,border:false,rowSelectorDepth:5,autoExpandColumn:"name",stripeRows:true});Zenoss.SimpleDeviceGridPanel.superclass.constructor.call(this,b)},setContext:function(a){this.getStore().load({params:{uid:a}})}});Ext.reg("SimpleDeviceGridPanel",Zenoss.SimpleDeviceGridPanel);Zenoss.DeviceGridPanel=Ext.extend(Zenoss.FilterGridPanel,{constructor:function(b){var a={xtype:"DeviceStore"};if(!Ext.isEmpty(b.directFn)){Ext.apply(a,{proxy:new Ext.data.DirectProxy({directFn:b.directFn})})}Ext.applyIf(b,{store:a,enableDragDrop:false,border:false,rowSelectorDepth:5,view:new Zenoss.FilterGridView({nearLimit:20,loadMask:{msg:"Loading. Please wait..."}}),autoExpandColumn:"name",cm:new Zenoss.DeviceColumnModel({defaults:{sortable:true}}),sm:new Zenoss.ExtraHooksSelectionModel(),stripeRows:true});Zenoss.DeviceGridPanel.superclass.constructor.call(this,b)}});Ext.reg("DeviceGridPanel",Zenoss.DeviceGridPanel)})();(function(){Ext.ns("Zenoss");Zenoss.ViewButton=Ext.extend(Ext.Button,{constructor:function(d){var b={enableToggle:true,toggleGroup:"CardButtonPanel",allowDepress:false};var a=Ext.apply(b,d);Zenoss.ViewButton.superclass.constructor.call(this,a)}});Ext.reg("ViewButton",Zenoss.ViewButton);Zenoss.CardButtonPanel=Ext.extend(Ext.Panel,{constructor:function(a){function b(g,f){return function(h,j){if(j){g.fireEvent("cardchange",f);g.getLayout().setActiveItem(f.id)}}}function d(h){var g=h.getTopToolbar();for(var f=0;f<h.items.getCount();++f){var j=h.items.get(f);if(j instanceof Ext.Panel){g.add({xtype:"ViewButton",id:"button_"+j.id,text:Ext.clean(j.buttonTitle,j.title,"Undefined"),pressed:(j==h.layout.activeItem),iconCls:j.iconCls,toggleHandler:b(h,j)})}}}function e(g,h,f){}Ext.applyIf(a,{id:"cardPanel",layout:"card",activeItem:0});Ext.apply(a,{header:false,tbar:[{xtype:"tbtext",text:_t("View: ")}]});this.addEvents("cardchange");this.on("afterrender",d,this);this.listeners=a.listeners;Zenoss.CardButtonPanel.superclass.constructor.call(this,a)}});Ext.reg("CardButtonPanel",Zenoss.CardButtonPanel)})();(function(){Ext.ns("Zenoss");Zenoss.ContextCardButtonPanel=Ext.extend(Zenoss.CardButtonPanel,{contextUid:null,initEvents:function(){this.on("cardchange",this.cardChangeHandler,this);Zenoss.CardButtonPanel.superclass.initEvents.call(this)},setContext:function(a){this.contextUid=a;panel=this.layout.activeItem;if(panel.setContext){panel.setContext(a)}},cardChangeHandler:function(a){if(a.setContext){a.setContext(this.contextUid)}}});Ext.reg("ContextCardButtonPanel",Zenoss.ContextCardButtonPanel)})();(function(){Ext.grid.CheckColumn=function(e){Ext.apply(this,e);if(!this.id){this.id=Ext.id()}this.renderer=this.renderer.createDelegate(this)};Ext.grid.CheckColumn.prototype={init:function(e){this.grid=e;this.grid.on("render",function(){var f=this.grid.getView();f.mainBody.on("mousedown",this.onMouseDown,this)},this)},onMouseDown:function(j,h){if(h.className&&h.className.indexOf("x-grid3-cc-"+this.id)!=-1){j.stopEvent();var g=this.grid.getView().findRowIndex(h);var f=this.grid.store.getAt(g);f.set(this.dataIndex,!f.data[this.dataIndex])}},renderer:function(f,g,e){g.css+=" x-grid3-check-col-td";return'<div class="x-grid3-check-col'+(f?"-on":"")+" x-grid3-cc-"+this.id+'"> </div>'}};Ext.ns("Zenoss");var b=new Ext.grid.CheckColumn({dataIndex:"enabled",header:"Enabled",width:90});var d=[["iaLoadInt5","1.3.6.1.4.1.2021.10.1.5.2",true,"SNMP"],["memAvailReal","1.3.6.1.4.1.2021.4.6.0",true,"Guage"],["memAvailSwap","1.3.6.1.4.1.2021.4.4.0",true,"SNMP"],["memBuffer","1.3.6.1.4.1.2021.4.14.0",true,"Guage"],["memCached","1.3.6.1.4.1.2021.4.15.0",true,"SNMP"],["SSCpuRawIdle","1.3.6.1.5.1.2021.11.53.0",true,"SNMP"],["SSCpuRawSystem","1.3.6.1.5.1.2021.10.11.52.0",true,"Guage"],["SSCpuRawUser","1.3.6.1.5.1.2021.10.11.50.0",false,"SNMP"],["SSCpuRawWait","1.3.6.1.5.1.2021.10.11.55.0",true,"Guage"],["sysUpTime","1.3.6.1.5.1.2021.1.0.0",true,"SNMP"]];var a=new Ext.data.ArrayStore({fields:[{name:"name"},{name:"source"},{name:"enabled"},{name:"type"}]});a.loadData(d);Zenoss.DatasourceGridPanel=Ext.extend(Ext.grid.EditorGridPanel,{constructor:function(e){Ext.applyIf(e,{autoExpandColumn:"name",stripeRows:true,store:a,plugins:b,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),cm:new Ext.grid.ColumnModel({columns:[{id:"name",dataIndex:"name",header:"Metrics by Datasource",width:300},{dataIndex:"source",header:"Source",width:300},b,{dataIndex:"type",header:"Type",width:90}]})});Zenoss.DatasourceGridPanel.superclass.constructor.call(this,e)}});Ext.reg("DatasourceGridPanel",Zenoss.DatasourceGridPanel)})();(function(){Ext.ns("Zenoss");function a(b){return function(d,e){Ext.getCmp(b).fireEvent("buttonClick",d.id)}}Zenoss.TreeFooterBar=Ext.extend(Ext.Toolbar,{constructor:function(b){Ext.applyIf(b,{border:false,items:[{id:"addButton",iconCls:"add",tooltip:"Add a child to the selected organizer",handler:a(b.bubbleTargetId)},{id:"deleteButton",iconCls:"delete",tooltip:"Delete the selected node",handler:a(b.bubbleTargetId)}]});Zenoss.TreeFooterBar.superclass.constructor.call(this,b)}});Ext.reg("TreeFooterBar",Zenoss.TreeFooterBar)})();(function(){Ext.ns("Zenoss");function a(j){var f=j.split(".");if(f.length>4){return false}while(f.length<4){f.push("0")}for(var g=0;g<f.length;g++){var d=parseInt(f[g]);if(!d&&d!=0){return false}try{if(d>255){return false}}catch(h){return false}f[g]=d.toString()}return f.join(".")}function b(e,d){return e.split(d).length-1}Zenoss.IpAddressField=Ext.extend(Ext.form.TextField,{constructor:function(d){d.maskRe=true;Zenoss.IpAddressField.superclass.constructor.call(this,d)},filterKeys:function(j,g){if(j.ctrlKey||j.isSpecialKey()){return}j.stopEvent();var h,o,m=g.selectionStart,k=g.selectionEnd,l=g.value.substring(0,m),f=g.value.substring(k),n=String.fromCharCode(j.getCharCode());if(n=="."){var o=l+f;m+=f.indexOf(".");var d=f.split(".")[1];if(k==m+1){m++}if(d){g.setSelectionRange(m+1,m+d.length+1)}}else{var o=a(l+n+f);if(o){m++;g.value=o;g.setSelectionRange(m,m)}}}});Ext.reg("ipaddressfield",Zenoss.IpAddressField)})();