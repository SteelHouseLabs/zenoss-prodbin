<tal:block metal:use-macro="here/templates/macros/page2">
<tal:block metal:fill-slot="contentPane">

<tal:block metal:define-macro="deviceStatusInfo"
           tal:define=" tabletitle string:Status;">
<tal:block metal:use-macro="here/zenuimacros/macros/zentable-slidingdoors">

<tal:block metal:fill-slot="title">
    Device Status
</tal:block>
<tal:block metal:fill-slot="body">
    <div style="padding:5px;border-bottom:1px solid #aaa;
                background-color:#f8f8f8">
    <ul class="inline-ul">
    <li> Device: <span tal:content="here/id" class="bigtext"/>
    <li> IP: <span tal:content="here/manageIp" class="bigtext"/>
    <li tal:define="isup python:here.getPingStatus()<1;
                           color python:test(isup, 'green', 'red');
                           desc python:test(isup, 'Up', 'Down')">
         Status: <img tal:attributes="src string:img/${color}_dot.png"
                      style="margin-bottom:-3px"/> 
                 <span tal:content="desc" class="bigtext"/></li>
    </ul>
    </div>
    <div class="yui-t1" style="width:100%;">
        <div class="yui-b yui-z">
            <div class="zentable-rainbow">
                <div metal:use-macro="here/rainbows/macros/vertical"></div>
            </div>
        </div>
        <div class="yui-b yui-z2">
            <dl class="faux-table">
                <dt class="first">Availability</dt>
                    <dd class="first" tal:content="here/availability"/>
                <dt>Uptime</dt>
                    <dd tal:content="here/uptimeStr"/>
                <dt>State</dt>
                    <dd tal:content="python:here.convertProdState(
                                                here.productionState)"/>
                <dt>Priority</dt>
                    <dd tal:content="python:here.convertPriority(
                                        here.priority)"/>
                <dt>Locks</dt>
                    <dd>
                    <tal:block tal:condition="python:not
                    (here.isLockedFromDeletion() and 
                     here.isLockedFromUpdates() and 
                     here.sendEventWhenBlocked())">None</tal:block>
                      <img tal:condition="here/isLockedFromDeletion" 
                           border="0" src="locked-delete-icon.png"
                           style="vertical-align:middle">
                      <img tal:condition="here/isLockedFromUpdates" 
                           border="0" src="locked-update-icon.png"
                           style="vertical-align:middle">
                      <img tal:condition="here/sendEventWhenBlocked" 
                           border="0" src="locked-sendevent-icon.png"
                           style="vertical-align:middle">
                  </dd>
                <dt>Last Change</dt>
                    <dd tal:content="here/getLastChangeString"/>
                <dt>Last Collection</dt>
                    <dd tal:content="here/getSnmpLastCollectionString"/>
                <dt>First Seen</dt>
                    <dd tal:content="here/getCreatedTimeString"/>

            </dl>
        </div>
        <div class="yui-b yui-z3">
            <div class="yui-skin-sam"
                 style="height:100%;
                        overflow-x:hidden;
                        overflow-y:auto;
                        background-color: #ccc;
                        border-left:1px solid #888">
            <div id="component-event-table"></div>
            </div>
            <script tal:define="evsum here/getDeviceComponentEventSummary"
              tal:content="structure string:
              var devcompevsum = ${evsum};
              compevsum = devcompevsum;
            "></script>
            <script>
            function makeComponentDataTable() {
                var columns = compevsum.columns;
                var data = compevsum.data;
                forEach(data, function(x){log((x['Component']))});
                var mycolumndefs = map(function(x){
                    return {key:x,sortable:true,resizeable:true}}, columns);
                var dataSource = new YAHOO.util.DataSource(data);
                dataSource.responseType = YAHOO.util.DataSource.TYPE_JSARRAY;
                dataSource.responseSchema = {fields:columns};
                oConfigs = {};
                var myDataTable = new YAHOO.widget.DataTable(
                    'component-event-table', mycolumndefs, dataSource, oConfigs);
            }
            YAHOO.zenoss.loader.require(["datatable", "datatablesamskin"]);
            YAHOO.zenoss.loader.insert(makeComponentDataTable);
            </script>
        </div>
    </div>
    <div style="clear:both;"></div>

<!-- END TABLE CONTENTS -->

</tal:block>
</tal:block>
</tal:block>

<span metal:use-macro="here/templates/macros/contentSeparator"/>


<tal:block tal:define=" tabletitle string:Device; "
    metal:define-macro="deviceOverview">
<tal:block metal:use-macro="here/zenuimacros/macros/zentable">
<tal:block metal:fill-slot="zentablecontents">

<!-- BEGIN TABLE CONTENTS -->
    <tr>
      <th class="tableheader">SNMP sysName</th>
      <td colspan='3' class="tablevalues" tal:content="here/snmpSysName"/>
    </tr>
    <tr>
      <td class="tableheader">Tag #</td>
      <td class="tablevalues" tal:content="here/hw/tag">123456</td>
      <td class="tableheader">Serial #</td>
      <td class="tablevalues" tal:content="here/hw/serialNumber">123456</td>
    </tr>
    <tr>
      <td class="tableheader">HW Manufacturer</td>
      <td class="tablevalues"
          tal:content="structure here/hw/getManufacturerLink"/>
      <td class="tableheader">HW Model</td>
      <td class="tablevalues"
          tal:content="structure here/hw/productClass/getPrimaryLink"/>
    </tr>
    <tr>
      <td class="tableheader">OS Manufacturer</td>
      <td class="tablevalues"
          tal:content="structure here/os/getManufacturerLink"/>
      <td class="tableheader">OS Version</td>
      <td class="tablevalues"
          tal:content="structure here/os/productClass/getPrimaryLink"/>
    </tr>
    <tr>
      <td class="tableheader">Location</td>
      <td class="tablevalues" 
        tal:content="structure here/getLocationLink"/>
      <td class="tableheader">Rack Slot</td>
      <td class="tablevalues" tal:content='here/rackSlot' />
    </tr>
    <tr>
      <td class="tableheader">SNMP Location</td>
      <td class="tablevalues" tal:content='here/snmpLocation' />
      <td class="tableheader">SNMP Contact</td>
      <td class="tablevalues" tal:content='here/snmpContact' />
    </tr>
    <tr>
      <td class="tableheader">SNMP Descr</td>
      <td class="tablevalues" colspan="3" tal:content="here/snmpDescr" />
    </tr>
    <tr tal:condition="here/snmpAgent">
      <td class="tableheader">SNMP Agent</td>
      <td class="tablevalues" colspan="3" tal:content="here/snmpAgent" />
    </tr>
    <tr>
      <td class="tableheader">Comments</td>
      <td class="tablevalues" colspan="3" tal:content="here/comments" />
    </tr>
    <tr>
      <td class="tableheader">Links</td>
      <td class="tablevalues" colspan="3" tal:content="structure here/getExpandedLinks" />
    </tr>
<!-- END TABLE CONTENTS -->

</tal:block>
</tal:block>
</tal:block>

<span metal:use-macro="here/templates/macros/contentSeparator"/>

<tal:block tal:define="tabletitle string:Related Organizers"
    metal:define-macro="deviceLinks">
<tal:block metal:use-macro="here/zenuimacros/macros/zentable">

<tal:block metal:fill-slot="zentablecontents">

<!-- BEGIN TABLE CONTENTS -->
    <tr tal:condition="python: hasattr(here, 'termserver') 
                        and here.termserver()">
        <th class="tableheader">Terminal Server</th>
        <td class="tablevalues" colspan=3>
            <span tal:content="structure here/termserver/getPrimaryLink"/>
            <a class="tablevalues" href=_
            tal:attributes="href python:'telnet:'+here.termserver().getId()">
            (telnet)</a>
        </td>
    </tr>
    <tr>
      <th class="tableheader">
        Systems
      </th>
      <td class="tablevalues" colspan="3">
      <span tal:repeat="item here/systems/objectValuesAll">
          <tal:block tal:content="structure python:item.getLink(text=item.getOrganizerName())"/>
      </span>
      </td>
    </tr>
    <tr tal:condition="python: hasattr(here, 'dhcpservers')">
      <th class="tableheader">
        DHCP Helper Servers
      </th>
      <td class="tablevalues" colspan="3">
      <span tal:repeat="item here/dhcpservers/objectValuesAll">
          <tal:block tal:content="structure python:item.getLink()"/> 
      </span>
      </td>
    </tr>
    <tr tal:condition="python: hasattr(here, 'dhcpubrclients') and 
            here.dhcpubrclients.countObjects()">
      <th class="tableheader">
        UBR Clients
      </th>
      <td class="tablevalues" colspan="3">
      <span tal:repeat="item here/dhcpubrclients/objectValuesAll">
          <tal:block tal:content="structure python:item.getLink()"/>
      </span>
      </td>
    </tr>
    <tr>
      <th class="tableheader">
        Groups
      </th>
      <td class="tablevalues" colspan="3">
      <span tal:repeat="item here/groups/objectValuesAll">
          <tal:block tal:content="structure python:item.getLink(text=item.getOrganizerName())"/>
      </span>
      </td>
    </tr>
    <tr>
      <th class="tableheader">
        Status Monitors
      </th>
      <td class="tablevalues" colspan="3">
      <span tal:repeat="item here/monitors/objectValuesAll">
          <tal:block tal:content="structure python:item.getLink(text=item.getOrganizerName())"/>
      </span>
      </td>
    </tr>
    <tr>
      <th class="tableheader">
        Performance Server
      </th>
      <td class="tablevalues" colspan="3">
        <span tal:replace="structure python: 
            here.perfServer.getPrimaryLink()">
          performance server
        </span>
      </td>
    </tr>

<!-- END TABLE CONTENTS -->

</tal:block>
</tal:block>
</tal:block>

</tal:block>
</tal:block>

