<form method="post" tal:attributes="action here/absolute_url_path" 
    name="deviceListForm" metal:define-macro="devList" 
    tal:condition='here/devices/countObjects'>
<script type="text/javascript" 
        src="/zport/portal_skins/zenmodel/submitViaEnter.js"></script>
<table class="zentable" cellpadding="3" cellspacing="1"
    tal:define="objects here/devices/objectValuesAll;
        tableName string:devicelistmacro;
        batch python:here.ZenTableManager.getBatch(tableName,objects);"
    tal:condition="python: batch or
                    here.ZenTableManager.getTableState(tableName, 'filter')"
    >
    <tr>
      <th class="tabletitle" align="left" colspan="5">
       Devices 
      </th>
    </tr>
    <input type='hidden' name='tableName' tal:attributes="value tableName" />
    <input type="hidden" name="zenScreenName" 
            tal:attributes="value template/id"/>
    <tbody metal:define-macro="devListBody">
    <tr>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                            tableName,'primarySortKey','Name')">Name
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                            tableName,'getDeviceIp','IP')">IP
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                            tableName,'getDeviceClassPath','Class')">Class
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                    tableName,'getProdState','State','cmp')">State
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                    tableName,'getSnmpStatusNumber','Critical/Error','cmp')">Critical/Error
        </th>
	</tr>
	<tr tal:repeat="device batch">
		<td class="tablevalues" align="left">
            <input tal:condition="here/editableDeviceList" 
                type="checkbox" name="deviceNames:list" 
                tal:attributes="value device/getRelationshipManagerId"/>
            <a class="tablevalues" href="_" 
                tal:attributes="href device/getDeviceUrl"
                tal:content="device/id">device
            </a>
        </td>
		<td class="tablevalues" align="left"
            tal:content="device/getDeviceIp">ip
        </td>
		<td class="tablevalues" align="left"
            tal:define="path device/getDeviceClassPath">
            <a href="" 
                tal:attributes="href string:/zport/dmd/Devices${path}"
                tal:content="path">type</a>
        </td>
		<td class="tablevalues" align="left"
            tal:content="device/getProdState">prodstate
        </td >
        <td class='tablevalues' tal:define="severity python:4">
        <table width="100%" 
            tal:on-error="structure string:
                <span class='errorvalues'>Events unavailable</span>">
            <tr>
                <td align=center width=16%
                tal:repeat="evt python:device.getEventSummary(severity)"
                tal:attributes="class python:evt[0]">
                    <span tal:replace="python:'%d/%d' % (evt[1],evt[2])"/>
                </td>
          </tr>
        </table>
        </td>
    </tr>
    </tbody>
    <tr>
        <td colspan=5 class="tableheader" align='center'>
            <span metal:use-macro="here/zenTableNavigation/macros/navbody" />
        </td>
    </tr>
    <tr tal:condition="here/editableDeviceList">
        <td class="tableheader" align="left" colspan="5">
            <input class="tableheader" type="submit" name="moveDevices:method"
                    value="Move To" />
            <select class="tableheader" name="moveTarget"
            tal:define="targets here/deviceMoveTargets">
                <option value=""></option>
                <option tal:repeat="target targets" 
                    tal:content="target">/Server/Linux</option>
            </select>
            |
            <input class="tableheader" type="submit" 
                name="removeDevices:method" value="Delete" />
            |
            <input class="tableheader" type="submit"
                    name="SelectButton" value="Select All" 
                    onClick="toggleSelect(this.form);return false"/>
        </td>
    </tr>
</table>
</form>


<span metal:define-macro="devListReportBody" tal:omit-tag="">
<tr>
    <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                        tableName,'primarySortKey','Name')"/>
    <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                        tableName,'getDeviceClassPath','Class')"/>
    <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                        tableName,'getHWProductName','Product')"/>
    <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                tableName,'getProdState','State')"/>
    <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                tableName,'getPingStatusNumber','Ping')"/>
    <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                tableName,'getSnmpStatusNumber','Snmp')"/>
</tr>
<tr tal:repeat="device batch">
    <td class="tablevalues" align="left">
        <a class="tablevalues" href="_" 
            tal:attributes="href device/getDeviceUrl"
            tal:content="device/id">device
        </a>
    </td>
    <td class="tablevalues" tal:content="device/getDeviceClassPath"/>
    <td class="tablevalues" tal:content="device/getHWProductName"/>
    <td class="tablevalues" tal:content="device/getProdState"/>
    <span metal:use-macro="here/deviceMacros/macros/pingStatus" />
    <span metal:use-macro="here/deviceMacros/macros/snmpStatus" />
</tr>
<tr>
    <td colspan="6" class="tableheader" align='center'>
        <form metal:use-macro="here/zenTableNavigation/macros/navtool"></form>
    </td>
</tr>
</span>


<form method="post" tal:attributes="action here/absolute_url_path" 
    name="deviceListForm" metal:define-macro="fullDevList">
<table class="zentable" cellpadding="3" cellspacing="1"
    tal:define="objects here/devices/getSubComponents;
        tableName string:devicelistmacro;
        batch python:here.ZenTableManager.getBatch(tableName,objects);"
    tal:condition="python: batch or
                    here.ZenTableManager.getTableState(tableName, 'filter')"
    >
    <tr>
      <th class="tabletitle" align="left" colspan="5">
       Devices 
      </th>
    </tr>
    <span metal:define-macro="fullDevListBody" tal:omit-tag="">
    <tr>
        <td colspan="5" class="tableheader" align='center'>
            <form metal:use-macro="here/zenTableNavigation/macros/navfilter"></form>
        </td>
    </tr>
    <tr>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                            tableName,'primarySortKey','Name')">Name
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                            tableName,'getDeviceIp','IP')">IP
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                            tableName,'getDeviceClassPath','Class')">Class
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                    tableName,'getProdState','State','cmp')">State
        </th>
        <th tal:replace="structure python:here.ZenTableManager.getTableHeader(
                    tableName,'getSnmpStatusNumber','Critical/Error','cmp')">Critical/Error
        </th>
	</tr>
	<tr tal:repeat="device batch">
		<td class="tablevalues" align="left">
            <a class="tablevalues" href="_" 
                tal:attributes="href device/getDeviceUrl"
                tal:content="device/id">device
            </a>
        </td>
		<td class="tablevalues" align="left"
            tal:content="device/getDeviceIp">ip
        </td>
		<td class="tablevalues" align="left"
            tal:define="path device/getDeviceClassPath">
            <a href="" 
                tal:attributes="href string:/zport/dmd/Devices${path}"
                tal:content="path">type</a>
        </td>
		<td class="tablevalues" align="left"
            tal:content="device/getProdState">prodstate
        </td >
        <td tal:define="severity python:4">
        <table class="zentable" border=0 cellpadding=0 cellspacing=1
            tal:on-error="structure string:
                <span class='errorvalues'>Events unavailable</span>">
            <tr>
                <td align=center width=16%
                tal:repeat="evt python:device.getEventSummary(severity)"
                tal:attributes="class python:evt[0]">
                    <span tal:replace="python:'%d/%d' % (evt[1],evt[2])"/>
                </td>
          </tr>
        </table>
        </td>
    </tr>
    <tr>
        <td colspan="5" class="tableheader" align='center'>
            <form metal:use-macro="here/zenTableNavigation/macros/navpagenofilter2"></form>
        </td>
    </tr>


    </span>
</table>
</form>
