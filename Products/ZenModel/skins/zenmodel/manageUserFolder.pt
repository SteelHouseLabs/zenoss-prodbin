<tal:block metal:use-macro="here/templates/macros/page1">

<tal:block metal:fill-slot="breadCrumbPane">
    /<a tal:attributes=
            "href string:${here/absolute_url_path}/${template/id}">Users
    </a>
</tal:block>

<tal:block metal:fill-slot="contentPane">
<form method="post" tal:attributes="action here/absolute_url_path">
<table class="zentable" cellspacing="1" cellpadding="3"
       tal:define="tableName string:userlist;
       ztm here/ZenTableManager;
       objects here/getAllUserSettings;
       batch python:ztm.getBatch(tableName, objects)"
       >
    <tr><th class="tabletitle" colspan="4">User Folder</th></tr>
    <tr>
        <th tal:replace="structure python:ztm.getTableHeader(
                            tableName,'primarySortKey','UserId')"/>
        <th tal:replace="structure python:ztm.getTableHeader(
                            tableName,'email','Email')"/>
        <th tal:replace="structure python:ztm.getTableHeader(
                            tableName,'pager','Pager')"/>
        <th tal:replace="structure python:ztm.getTableHeader(
                            tableName,'roles','Roles')"/>
    </tr>
    <tr tal:repeat="user batch">
        <td class="tablevalues">
        <input type="checkbox" name="userids:list" 
            tal:condition="here/isManager" tal:attributes="value user/getId" />
            <a tal:attributes="href user/getPrimaryUrlPath"
               tal:condition="user/iseditable" 
               tal:content="user/getId">edahl</a>
            <span tal:condition="not: user/iseditable" 
                  tal:content="user/getId"/>
        </td>
        <td class="tablevalues" tal:content="user/email"/>
        <td class="tablevalues" tal:content="user/pager"/>
        <td class="tablevalues" 
            tal:content="python:', '.join(user.getUserRoles())"/>
    </tr>
    <tr>
        <td colspan="4" class="tableheader">
            <span metal:use-macro="here/zenTableNavigation/macros/navbody"/>
        </td>
    </tr>
    <tr tal:condition="here/isManager">
    <td class="tableheader" colspan="4">
        Userid:
        <input class="tableheader" type="text" name="userid" size=10/>
        Email:
        <input class="tableheader" type="text" name="email"
           onkeypress="return submitViaEnter(event,'manage_addUser');"/>
        <input class="tableheader" type="submit" 
            name="manage_addUser:method" value=" Add " /> 
        |
        <input class="tableheader" type="submit" 
            name="manage_deleteUsers:method" value=" Delete " />
        |
        <input class="tableheader" type="submit"
                name="SelectButton" value="Select All" 
                onClick="toggleSelect(this.form);return false"/>
    </td>
    </tr>
</table>
</form>
</tal:block>
</tal:block>
