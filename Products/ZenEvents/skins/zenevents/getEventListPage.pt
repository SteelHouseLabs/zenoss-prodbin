<tal:block metal:define-macro="page"
    tal:define="
        severity request/severity | python:2;
        state request/state | python:1;
        objects python:here.getEventList(severity=severity,state=state);
        sortedHeader request/sortedHeader | string:;
        resultFields request/ev_resultfields | here/getResultFields | 
                        here/ZenEventManager/defaultResultFields;
        filter request/filter | string:;
        evcolspan python:len(resultFields);
        evcolspan python:here.isManager() and evcolspan + 1 or evcolspan;
        ztm here/ZenTableManager;
        objects python:ztm.filterObjects(objects,filter,resultFields);
        objects python:ztm.sortObjects(objects,request);
        batch python:ztm.getBatchForm(objects,request);"
        tal:on-error="structure here/eventsError">
    <script type="text/javascript">
        var eventsurl='/zport/dmd/ZenEventManager/getJSONEventsInfo'
    </script>
    <tal:block metal:define-macro="eventRow">
    <tr tal:repeat="event batch" 
        tal:attributes="class event/getCssClass">
    <td tal:condition="here/isManager">
        <input type="checkbox" name="evids:list" 
            tal:attributes="value event/evid"/>
    </td>
    <tal:block tal:define="evclick 
        string:javascript:eventWindow('${event/zem}','${event/evid}')">
    <td tal:repeat="data python:event.getDataListWithLinks(resultFields, event.getCssClass())"
        tal:attributes="onclick python:repeat['data'].end and evclick or ''"
        tal:content="structure data">
        event data
    </td>
    </tal:block>
    </tr>
    </tal:block>
    <tr>
        <td class="tableheader" tal:attributes="colspan evcolspan">
            <span metal:use-macro=
                "here/zenTableNavigation/macros/navbodynofilter" />
        </td>
    </tr>
</tal:block>
