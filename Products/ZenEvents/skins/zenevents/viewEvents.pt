<tal:block metal:use-macro="here/templates/macros/page2">
<tal:block metal:fill-slot="contentPane">

<script type="text/javascript" src="/zport/js/MochiKit.js"></script>
<script type="text/javascript">	var djConfig = { isDebug: true }; </script>
<script type="text/javascript" src="/zport/js/dojo/dojo.js"></script>
<script type="text/javascript" 
        src="/zport/portal_skins/zenevents/zeneventsfuncs.js"></script>
<form name="control" method="post" tal:attributes="action request/URL"
    tal:define="
    whereclause request/ev_whereclause | here/eventWhere | string:;
    orderby request/ev_orderby | here/eventOrderby | string:;
    resultFields request/ev_resultfields | here/getResultFields | 
                    here/ZenEventManager/defaultResultFields;
    evcolspan python:len(resultFields)+1;
    severity request/severity | python:2;
    sortedHeader request/sortedHeader | string:;
    page string:getEventListPage;
    ">
    <!--tal:on-error="structure here/eventsError"-->
<table class="zentable" cellpadding="3" cellspacing="1"
    metal:define-macro="eventTable">
    <tal:block metal:define-macro="header">
    <input type='hidden' name='sortedHeader' 
        tal:attributes="value sortedHeader"/>
    <input type='hidden' name='sortedSence' value="">
    <input type='hidden' name='url'
      tal:attributes="value string:${here/absolute_url_path}/${page}"/>
    <input type='hidden' name='zenScreenName'
        tal:attributes="value template/id" />
    <tr>
        <td class="tabletitle" colspan=4 tal:attributes="colspan evcolspan">
            Events:
            &nbsp; &nbsp;
            Filter
            <input class="tableheader" type="text" name="filter" 
                size=25 onkeypress="getPageViaEnter(event)"
                tal:attributes="value request/filter | string:">
            &nbsp; &nbsp;
            Severity Filter
            <select class="tableheader" name="severity:int"
                    onchange="getTablePage(this.form)">
                <option tal:repeat="sev here/ZenEventManager/getSeverities"
                    tal:content="python:sev[0]"
                    tal:attributes="value python:sev[1]; 
                                    selected python:sev[1]==severity" />
            </select>
            &nbsp; &nbsp;
            <input class="navcontrol" type="button" 
                name="refresh" value="Start Auto-Refresh"
                onclick="startRefresh(this, this.form);">
            <input class="tableheader" type="text" name="refreshRate" 
                size='2' value='10'>
                
        </td>
    </tr>
    <tr>
        <th class="tableheader" align="left" 
            tal:repeat="headername resultFields">
            <input type="button" class="navcontrol"
                tal:attributes="name headername; value headername"
                onclick="setSortedHeader(this.name, this.form);">
        </th>
        <th class=tableheader> </th>
    </tr>
    </tal:block>
    <tbody id="eventsBody">
        <span metal:use-macro="here/getEventListPage/macros/page"/>
    </tbody>
</table>
</form>    

</tal:block>
</tal:block>
