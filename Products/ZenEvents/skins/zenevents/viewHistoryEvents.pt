<tal:block metal:use-macro="here/templates/macros/page2">
<tal:block metal:fill-slot="contentPane">

<span metal:define-macro="body">
<script type="text/javascript" src="/zport/js/MochiKit.js"></script>
<script type="text/javascript">	var djConfig = { isDebug: true }; </script>
<script type="text/javascript" src="/zport/js/dojo/dojo.js"></script>
<script type="text/javascript" 
        src="/zport/portal_skins/zenevents/zeneventsfuncs.js"></script>
<script type="text/javascript" src="/zport/portal_skins/zenmodel/datePicker.js">
</script>
<script type="text/javascript">
function datePickerClosed(targetInput) {
    if (targetInput.name == "startDate") {
        startDate = targetInput.value;
        endDateInput = targetInput.form.endDate;
    } else {
        startDate = targetInput.form.startDate.value;
        endDateInput = targetInput;
    } 
    var sdate = getFieldDate(startDate);
    var edate = getFieldDate(endDateInput.value);
    if (sdate.getTime() + 86400000 >= edate.getTime()) {
        edate = new Date(sdate.getTime() + 86400000);
        endDateInput.value = getDateString(edate);
    }
    return true;
};
</script>

<form method="post" tal:attributes="action here/absolute_url_path"
    tal:define="
    whereclause request/ev_whereclause | here/eventWhere | string:;
    orderby request/ev_orderby | here/eventOrderby | string:;
    resultFields request/ev_resultfields | here/getResultFields |
                    here/ZenEventHistory/defaultResultFields;
    evcolspan python:len(resultFields)+1;
    severity request/severity | python:2;
    sortedHeader request/sortedHeader | string:;
    page string:getHistoryEventListPage;
    ">
<span metal:define-macro="events">
<table class="zentable" cellpadding="3" cellspacing="1">
    <tr class=tableheader>
    <td>Start Date: 
    <input class="tableheader" type="text" name="startDate" readonly="true"
        tal:attributes="value here/yesterdayDate"/>
    <input class="tableheader" type="button" value="select" 
        onclick="displayDatePicker('startDate');"/>
    </td>
    <td>End Date: 
    <input class="tableheader" type="text" name="endDate" readonly="true"
        tal:attributes="value here/todayDate"/>
    <input class="tableheader" type="button" value="select" 
        onclick="displayDatePicker('endDate');" />
    </td>
    <td>
    <input class="tableheader" type="submit" name="search" value=" Search " 
        onclick="getTablePage(this.form);return false;"/>
    </td>
    </tr>
</table>

<span metal:use-macro="here/templates/macros/contentSeparator"/>

<table class="zentable" cellpadding="3" cellspacing="1">
    <tal:block metal:use-macro="here/viewEvents/macros/header"/>
    <tbody id="eventsBody">
        <span metal:use-macro="here/getHistoryEventListPage/macros/page"/>
    </tbody>
</table>
</span>
</form>
</span>

</tal:block>
</tal:block>
