<html><head><body bgcolor="#FFFFFF">
<b>SiteScopeParser - Using: Extracting data from a SiteScopeParser</b>

    Description</b>

        The SiteScopeParser product has multiple ways in which
        to represent the data it manages from SiteScope. Using
        these methods, you can build flexible websites to display
        this information.

        This information is available either as a single entity
        (i.e., a single Group if processing the Panel, or a single
        Monitor if processing a Group) or a list of entities.

        These entities have a collection of methods to access each
        field of data, such as a Monitor's Name or Condition.

    Referencing the SiteScopeParser</b>

        When working with a SiteScopeParser in DTML, you must
        explicitly reference it by its Id property. This is
        accomplished with the <i><xmp>
            <dtml-with>
        </xmp></i> tag. For example if
        we have a SiteScopeParser whose Id is sstest, we would
        say:

        <i><xmp>
            <dtml-with sstest>
        </xmp></i>

        All references to the SiteScopeParser must be enclosed in
        this. When we are through with our SiteScopeParser, we tell
        DTML that we no longer need to use it by closing the
        <i><xmp>
            <dtml-with>
        </xmp></i> tag, like this:

        <i><xmp>
            </dtml-with>
        </xmp></i>

    A list of entities</b>

        In order to retrieve a list of entities, we use the
        <i><xmp>
            <dtml-in>
        </xmp></i> tag. This tag lets us loop over the entities.
        We accomplish this by calling our SiteScopeParser's
        getRowList method, like this:

        <i><xmp>
            <dtml-in getRowList>
        </xmp></i>

        When we have finished our loop, we must again tell DTML
        that we have completed. This is done in a similar manner
        to the <i><xmp>
            <dtml-with>
        </xmp></i> tag:

        <i><xmp>
            </dtml-in>
        </xmp></i>

    A single entity

        Retrieval of a single entity is performed inside of another
        <i><xmp>
            <dtml-with>
        </xmp></i>tag. This tag is slightly different than the one
        we use to reference the SiteScopeParser. Inside of this one,
        we call the SiteScopeParser's getRowByName method to return
        the row we want. For example, suppose we are looking at the
        DNS Group and we want to pull the Caching Monitor. We could
        do this with the following <i><xmp>
            <dtml-with>
        </xmp></i> tag:

        <i><xmp>
            <dtml-with expr="getRowByName('Caching')">
        </xmp></i>

        Remember that we have to close our <i><xmp>
            <dtml-with>
        </xmp></i> when we are
        done with it.

    <b>Retrieving fields from an entity</b>

        Inside of our <i><xmp>
            <dtml-with>
        </xmp></i> and <i><xmp>
            <dtml-in>
        </xmp></i> tags, we want to
        access the fields of the entity we are referencing. To do
        this, the SiteScopeParser provides you with methods named
        after all the fields. The data from these fields can be
        inserted into the DTML document by calling one of these
        methods through the <i><xmp>
            <dtml-var>
        </xmp></i> tag. For example, to get
        an entities Name field:

        <i><xmp>
            <dtml-var Name>
        </xmp></i>

        A list of available methods follows:

        <i>
            Name
        </i>

        <i>
            Condition
        </i>

        <i>
            More
        </i>

        <i>
            Ack
        </i>

        <i>
            Refresh
        </i>

        <i>
            Gauge
        </i>

        <i>
            Updated
        </i>

        <i>
            Status
        </i>

        Some of these methods contain links. If you would like to
        disallow the user from seeing these links, you may add NoRef
        to the end of the method name. For example, to get the Name
        field without generating a link:

        <i><xmp>
            <dtml-var NameNoRef>
        </xmp></i>

    An example:

        If you were trying to access the Condition field for the
        Caching Monitor in the DNS Group, you would first create
        a SiteScopeParser and point it at the DetailDNS.html page
        in SiteScope. Once your SiteScopeParser was created, you
        would write a DTML method similar to the following:

        <i><xmp>
        <dtml-var standard_html_header>
        <dtml-with sstest>
        <dtml-in expr="getRowByName(&quot;Caching&quot;)">
        <dtml-var Condition>
        </dtml-in>
        </dtml-with>
        <dtml-var standard_html_footer>
        </xmp></i>
