<span tal:replace="structure here/standard_html_header"/>
<span metal:use-macro="here/top/macros/header" />
<br>
<script metal:use-macro="here/miscmacros/macros/popupwindow"></script>
<script type="text/javascript" 
        src="/zport/portal_skins/zenmodel/submitViaEnter.js"></script>
<form method="post" tal:attributes="action request/URL"
    tal:define="
    whereclause request/ev_whereclause | here/eventWhere | string:;
    orderby request/ev_orderby | here/eventOrderby | string:;
    resultFields request/ev_resultfields | here/eventResultFields | 
                    here/netcool/resultFields;
    ">
<table class="zentable" cellpadding="3" cellspacing="1"
    metal:define-macro="eventTable"
    tal:define="tableName string:viewevents;
    deftsort python: here.ZenTableManager.getTableState(
                        tableName,sortedHeader='');
    sevlevel python: here.ZenTableManager.setReqTableState(
                        tableName,'severity',default=2,reset=True);
    objects python:here.netcool.getEvents(where=whereclause, orderby=orderby, 
                        resultFields=resultFields, severity=sevlevel);
    batch python:here.ZenTableManager.getBatch(tableName,objects);
    evcolspan python:len(resultFields)+1;"
    >
    <input type='hidden' name='tableName'
        tal:attributes="value tableName" />
    <input type='hidden' name='zenScreenName'
        tal:attributes="value template/id" />
    <tr>
        <td class="tabletitle" colspan=4 tal:attributes="colspan evcolspan">
            Events:
            &nbsp; &nbsp;
            Not
            <input class=tabletitle type=checkbox name=negateFilter value=1 
                tal:attributes="checked 
                    python:here.ZenTableManager.getTableState(
                                        tableName, 'negateFilter')"/>
            Filter
            <input class="tableheader" type="text" name="filter" 
                size=25 onkeypress="submitViaEnter(event)"
                tal:attributes="value python:here.ZenTableManager.getTableState(
                                        tableName,'filter')">
            &nbsp; &nbsp;
            Severity Filter
            <select class="tableheader" name="severity:int"
                    onchange="this.form.submit()">
                <option tal:repeat="sev here/netcool/getSeverities"
                    tal:content="python:sev[0]"
                    tal:attributes="value python:sev[1]; 
                                    selected python:sev[1]==sevlevel" />
            </select>
        </td>
    </tr>
    <tr>
        <th tal:repeat="headername resultFields"
            tal:replace="structure python:here.ZenTableManager.getTableHeader(
                    tableName,headername,headername,'cmp')">Name
        </th>
        <th class=tableheader> </th>
    </tr>
    <tr class="statusvalues" bgcolor="#FF0000" style="color: #000000;"
        tal:repeat="event batch"
        tal:attributes="bgcolor event/bgcolor; 
        style python: 'color:'+event.fgcolor">
        <span tal:repeat="index python: range(event.getfieldcount())">
        <td tal:content="python: event.getfield(index)">
            event data 
        </td>
        </span>
        <td>
            <a href="_"
                tal:attributes="href python:
                'javascript:popupwindow(\''+event.getEventDetailHref()
                +'\',\'ncoeventdetail'+str(event.ServerSerial)+'\',450,550)'">
                *
            </a>
        </td>
    </tr>
    <tr>
        <td colspan=4 class="tableheader" align='center'
            tal:attributes="colspan evcolspan">
            <span metal:use-macro=
                "here/zenTableNavigation/macros/navbodynofilter" />
        </td>
    </tr>
</table>
</form>    
<span tal:replace="structure here/standard_html_footer"/>
